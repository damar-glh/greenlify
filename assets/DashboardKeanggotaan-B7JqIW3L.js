import{q as j,aA as f,r as c,u as _,j as e,a0 as z,a1 as H,T as o,B as d,a8 as W,a3 as B,a4 as C,a5 as A,k as T,l as y,m as v,n as M,I as m}from"./index-Bjp6i5Kc.js";import{C as L,b as K}from"./card-Dd2CSfRw.js";import{T as V,a as U,b as E,c as h,d as J,e as p}from"./table-CMYNHUyL.js";import{B as Q,a as X,b as D,c as R,d as I,e as Y}from"./breadcrumb-DETTni7P.js";import{L as x}from"./label-BMYCyKBQ.js";import{u as Z}from"./useDateStore-KkonUMz-.js";import{P as ee}from"./plus-DCjz8vl6.js";import{P as ae}from"./pencil-CAjUoBxd.js";import{T as se}from"./trash-2-NJB4vD0_.js";async function te(){try{const t=localStorage.getItem("access_token");if(!t)return"Token tidak tersedia. Silakan login kembali.";const s=await j.get(f,{headers:{Authorization:`Bearer ${t}`}});return s.data&&s.data.data?s.data.data:(console.error("Data member tidak ditemukan di respons API."),"Data member tidak ditemukan.")}catch(t){throw console.error("Gagal mendapatkan data member:",t.response||t.message),new Error("Gagal mengambil data member. Silakan coba lagi.")}}async function re(t){try{const s=localStorage.getItem("access_token");return s?(await j.post(f,t,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}})).data:"Token tidak tersedia. Silakan login kembali."}catch(s){throw console.error("Gagal menambahkan member:",s.response||s.message),new Error("Gagal menambahkan member. Silakan coba lagi.")}}async function le(t,s){try{const n=localStorage.getItem("access_token");return n?(await j.put(`${f}/${t}`,s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}})).data:"Token tidak tersedia. Silakan login kembali."}catch(n){throw console.error("Gagal memperbarui member:",n.response||n.message),new Error("Gagal memperbarui member. Silakan coba lagi.")}}async function ne(t){try{const s=localStorage.getItem("access_token");return s?(await j.delete(`${f}/${t}`,{headers:{Authorization:`Bearer ${s}`}})).data:"Token tidak tersedia. Silakan login kembali."}catch(s){throw console.error("Gagal menghapus member:",s.response||s.message),new Error("Gagal menghapus member. Silakan coba lagi.")}}function ue(){const[t,s]=c.useState([]),[n,g]=c.useState(!1),[F,k]=c.useState(!1),[G,u]=c.useState(!1),[l,S]=c.useState(null),{formatDate:O}=Z(),{toast:i}=_(),b=async()=>{try{const a=await te();s(a)}catch(a){i({title:"Error",description:a.message,variant:"destructive"})}},P=async a=>{a.preventDefault();const r=new FormData(a.target),N={desa:r.get("desa"),rw:r.get("rw"),rt:r.get("rt")};try{await re(N),i({title:"Berhasil",description:"Member baru telah ditambahkan"}),g(!1),await b(),a.target.reset()}catch(w){i({title:"Member Gagal Ditambahkan",description:w.message,variant:"destructive"})}},$=async a=>{a.preventDefault();const r=new FormData(a.target),N={desa:r.get("desa"),rw:r.get("rw"),rt:r.get("rt")};try{await le(l.id,N),i({title:"Berhasil",description:"Member telah diperbarui."}),k(!1),await b()}catch(w){i({title:"Terjadi Kesalahan",description:w.message,variant:"destructive"})}},q=async a=>{try{await ne(a),u(!1),i({title:"Berhasil",description:"Member telah dihapus"}),await b()}catch(r){i({title:"Terjadi Kesalahan",description:r.message,variant:"destructive"})}};return c.useEffect(()=>{(async()=>{try{await b()}catch(r){console.error("Failed to load members:",r)}})().then(r=>r).catch(console.error)},[]),e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 px-4",children:[e.jsx(z,{className:"-ml-1"}),e.jsx(H,{orientation:"vertical",className:"mr-2 h-4"}),e.jsx(Q,{children:e.jsxs(X,{children:[e.jsx(D,{className:"hidden md:block",children:e.jsx(R,{href:"/",className:"text-[16px] font-normal leading-[28px]",children:"Beranda"})}),e.jsx(I,{className:"hidden md:block"}),e.jsx(D,{children:e.jsx(R,{href:"/Dashboard",className:"text-[16px] font-normal leading-[28px]",children:"Dashboard"})}),e.jsx(I,{className:"hidden md:block"}),e.jsx(D,{children:e.jsx(Y,{className:"text-[16px] font-normal leading-[28px]",children:"Anggota"})})]})})]})}),e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0 ",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mr-0 md:mr-6",children:[e.jsxs("div",{children:[e.jsx(o,{variant:"h1",className:"text-4xl lg:text-5xl",children:"Manajemen Anggota"}),e.jsx(o,{variant:"p",className:"text-slate-700 mt-4",children:"Tambahkan anggota baru untuk memperluas jaringan dan meningkatkan kolaborasi dalam komunitas."})]}),e.jsxs(d,{variant:"primary",className:"text-white shadow-lg",onClick:()=>g(!0),children:[e.jsx(ee,{className:"w-6 h-6 mr-2"}),"Tambah Keanggotaan"]})]}),e.jsx("div",{className:"grid gap-4 grid-cols-1",children:e.jsx(L,{children:e.jsx(K,{children:e.jsxs(V,{children:[e.jsx(U,{children:e.jsxs(E,{children:[e.jsx(h,{className:"text-xl text-center",children:"Nama Desa"}),e.jsx(h,{className:"text-xl text-center",children:"No. RW"}),e.jsx(h,{className:"text-xl text-center",children:"No. RT"}),e.jsx(h,{className:"text-xl text-center",children:"Tanggal Bergabung"}),e.jsx(h,{className:"text-xl text-right",children:"Aksi"})]})}),e.jsx(J,{children:t.map(a=>e.jsxs(E,{children:[e.jsx(p,{className:"text-center",children:a.desa}),e.jsxs(p,{className:"text-center",children:["RW ",a.rw]}),e.jsxs(p,{className:"text-center",children:["RT ",a.rt]}),e.jsx(p,{className:"text-center",children:O(a.created_at)}),e.jsx(p,{className:"text-right",children:e.jsx(W,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(B,{children:[e.jsx(C,{asChild:!0,children:e.jsx(d,{variant:"outline",size:"icon",onClick:()=>{S(a),k(!0)},children:e.jsx(ae,{className:"w-4 h-4"})})}),e.jsx(A,{className:"bg-emerald-600",children:e.jsx(o,{variant:"p",className:"text-background",children:"Edit Member"})})]}),e.jsxs(B,{children:[e.jsx(C,{asChild:!0,children:e.jsx(d,{variant:"outline",size:"icon",className:"text-red-500 hover:text-red-600",onClick:()=>{S(a),u(!0)},children:e.jsx(se,{className:"w-4 h-4"})})}),e.jsx(A,{className:"bg-emerald-600",children:e.jsx(o,{variant:"p",className:"text-background",children:"Hapus Member"})})]})]})})})]},a.id))})]})})})})]}),e.jsx(T,{open:n,onOpenChange:g,children:e.jsxs(y,{children:[e.jsxs(v,{className:"space-y-4",children:[e.jsx(M,{className:"text-center text-[30px] font-bold leading-[36px]",children:"Tambah Anggota Baru"}),e.jsx(o,{variant:"p",className:"text-left max-w-lg text-slate-500",children:"Tambahkan data anggota baru dengan mengisi form berikut."})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(x,{htmlFor:"desa",className:"text-[18px] font-bold text-emerald-600",children:"Nama Desa"}),e.jsx(m,{id:"desa",name:"desa",required:!0,placeholder:"Masukkan nama desa",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(x,{htmlFor:"rw",className:"text-[18px] font-bold text-emerald-600",children:"RW"}),e.jsx(m,{id:"rw",name:"rw",required:!0,placeholder:"Masukkan nomor RW",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(x,{htmlFor:"rt",className:"text-[18px] font-bold text-emerald-600",children:"RT"}),e.jsx(m,{id:"rt",name:"rt",required:!0,placeholder:"Masukkan nomor RT",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100"})]}),e.jsx(d,{type:"submit",className:"w-full",children:"Simpan"})]})]})}),e.jsx(T,{open:F,onOpenChange:k,children:e.jsxs(y,{children:[e.jsxs(v,{className:"space-y-4",children:[e.jsx(M,{className:"text-center text-[30px] font-bold leading-[36px]",children:"Edit Anggota"}),e.jsx(o,{variant:"p",className:"text-left max-w-lg text-slate-500",children:"Ubah informasi anggota untuk memperbarui data keanggotaan."})]}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(x,{htmlFor:"desa",className:"text-[18px] font-bold text-emerald-600",children:"Nama Desa"}),e.jsx(m,{id:"desa",name:"desa",required:!0,defaultValue:(l==null?void 0:l.desa)||"",placeholder:"Masukkan nama desa",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(x,{htmlFor:"rw",className:"text-[18px] font-bold text-emerald-600",children:"RW"}),e.jsx(m,{id:"rw",name:"rw",required:!0,defaultValue:(l==null?void 0:l.rw)||"",placeholder:"Masukkan nomor RW",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(x,{htmlFor:"rt",className:"text-[18px] font-bold text-emerald-600",children:"RT"}),e.jsx(m,{id:"rt",name:"rt",required:!0,defaultValue:(l==null?void 0:l.rt)||"",placeholder:"Masukkan nomor RT",className:"h-12 text-slate-900 border border-slate-50 focus:border-slate-100"})]}),e.jsx(d,{type:"submit",className:"w-full",children:"Simpan Perubahan"})]})]})}),e.jsx(T,{open:G,onOpenChange:u,children:e.jsxs(y,{children:[e.jsxs(v,{className:"space-y-4",children:[e.jsx(M,{className:"text-left text-[30px] font-bold leading-[36px]",children:"Hapus Anggota"}),e.jsx(o,{variant:"p",className:"text-left max-w-lg text-slate-500",children:"Apakah Anda yakin ingin menghapus data anggota ini? Data yang dihapus tidak dapat dikembalikan."})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(d,{variant:"secondary",onClick:()=>u(!1),children:"Batal"}),e.jsx(d,{variant:"destructive",onClick:()=>q(l.id),children:"Hapus"})]})]})})]})}export{ue as default};
//# sourceMappingURL=DashboardKeanggotaan-B7JqIW3L.js.map
